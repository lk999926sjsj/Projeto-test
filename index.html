<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Site Personalizável</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados para a fonte Inter e para garantir que o corpo ocupe toda a altura */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh; /* Garante que o corpo ocupe a altura total da viewport */
            display: flex; /* Permite centralizar o conteúdo verticalmente */
            justify-content: center; /* Centraliza o conteúdo horizontalmente */
            align-items: center; /* Centraliza o conteúdo verticalmente */
            background-color: #f0f4f8; /* Cor de fundo suave (fallback) */
            overflow: hidden; /* Evita barras de rolagem */
            position: relative; /* Necessário para posicionar o conteúdo */
            /* --- PONTO DE ALTERAÇÃO: PAPEL DE PAREDE DE IMAGEM --- */
            background-image: url('https://backiee.com/static/wallpapers/560x315/411581.jpg'); /* URL da sua imagem de fundo */
            background-size: cover; /* Faz a imagem cobrir toda a área */
            background-position: center; /* Centraliza a imagem */
            background-repeat: no-repeat; /* Evita que a imagem se repita */
            background-attachment: fixed; /* Mantém a imagem fixa ao rolar a página */
        }

        /* Removido o estilo para #video-background, pois não há mais vídeo */

        /* Estilo para a caixa de mensagem personalizada */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50; /* Verde para sucesso */
            color: white; /* Alterado para branco para melhor contraste */
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none; /* Escondido por padrão */
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .message-box.error {
            background-color: #f44336; /* Vermelho para erro */
        }
        .message-box.show {
            display: block;
            opacity: 1;
        }
        /* Removida a transição de cor de fundo para o painel de login, agora é transparente */
        #loginPanel {
            background-color: transparent; /* Fundo totalmente transparente */
            box-shadow: none; /* Removendo a sombra para um visual mais limpo e transparente */
            z-index: 1; /* Garante que o painel fique acima do fundo */
            position: relative; /* Necessário para z-index funcionar corretamente */
        }
        /* Estilo para o botão de login transparente */
        #loginButton {
            background-color: transparent; /* Fundo transparente */
            border: 2px solid white; /* Borda branca para visibilidade */
            /* A transição de cor de fundo será aplicada ao hover */
            transition: background-color 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        /* Estilo de hover para o botão transparente */
        #loginButton:hover {
            background-color: rgba(255, 255, 255, 0.2); /* Fundo branco semi-transparente no hover */
            transform: scale(1.05); /* Mantém o efeito de escala no hover */
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div id="messageBox" class="message-box rounded-lg"></div>

    <div id="loginPanel" class="p-8 rounded-xl w-full max-w-md text-center">
        <h2 class="text-3xl font-bold mb-6 text-white">logue com sua conta</h2>
        <div class="mb-4">
            <input type="text" id="username" placeholder="Usuário" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 bg-gray-700 text-white placeholder-gray-400">
        </div>
        <div class="mb-6">
            <input type="password" id="password" placeholder="Senha" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 bg-gray-700 text-white placeholder-gray-400">
        </div>
        <button id="loginButton" class="w-full text-white py-3 rounded-lg shadow-md">Entrar</button>
    </div>

    <div id="dashboardPanel" class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl text-center hidden">
        <h2 class="text-3xl font-bold mb-8 text-gray-800">Bem-vindo(a) ao seu Painel!</h2>
        <p class="text-lg text-gray-600 mb-8">Escolha uma função abaixo:</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <button id="function1Button" class="bg-red-500 text-white py-4 px-6 rounded-lg hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105 shadow-md text-lg font-semibold">
                Função 1: scripts
            </button>
            <button id="function2Button" class="bg-red-500 text-white py-4 px-6 rounded-lg hover:bg-purple-600 transition duration-300 ease-in-out transform hover:scale-105 shadow-md text-lg font-semibold">
                Função 2: apostila unlock
            </button>
            <button id="function3Button" class="bg-red-500 text-white py-4 px-6 rounded-lg hover:bg-red-600 transition duration-300 ease-in-out transform hover:scale-105 shadow-md text-lg font-semibold">
                Função 3: tutoriais
            </button>
        </div>
        <button id="logoutButton" class="mt-10 bg-gray-300 text-gray-800 py-2 px-6 rounded-lg hover:bg-gray-400 transition duration-300 ease-in-out transform hover:scale-105 shadow-md">Sair</button>
    </div>

    <script>
        // Função para exibir mensagens personalizadas
        function showMessage(message, type = 'success') {
            const messageBox = document.getElementById('messageBox');
            messageBox.textContent = message;
            messageBox.className = 'message-box rounded-lg show'; // Reset classes and show
            if (type === 'error') {
                messageBox.classList.add('error');
            } else {
                messageBox.classList.remove('error');
            }

            // Esconde a mensagem após 3 segundos
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, 3000);
        }

        // Obtém referências aos elementos HTML
        const loginPanel = document.getElementById('loginPanel');
        const dashboardPanel = document.getElementById('dashboardPanel');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginButton = document.getElementById('loginButton');
        const logoutButton = document.getElementById('logoutButton');
        const function1Button = document.getElementById('function1Button');
        const function2Button = document.getElementById('function2Button');
        const function3Button = document.getElementById('function3Button');

        // --- PONTO DE ALTERAÇÃO: CREDENCIAIS DE LOGIN ---
        // Lista de usuários e senhas permitidos.
        const USERS = [
            { username: 'ana', password: 'lucas' },
            { username: 'iris', password: 'iris123' },
            { username: 'carlos', password: 'carlos123' },
            { username: 'joao', password: 'joao123' },
            { username: 'luismiguel', password: 'luismiguel23' },
            { username: 'lara', password: 'lara' },
            { username: 'rafael', password: 'code123' },
            { username: 'julia', password: 'designpass' },
            { username: 'bruno', password: 'gamer123' },
            { username: 'laura', password: 'securepass' }
        ];

        // --- LISTA NEGRA DE USUÁRIOS (bloqueia o acesso mesmo com senha correta) ---
        const BLOCKED_USERS = [
            // 'joao', // Exemplo de usuário bloqueado
            // 'bruno' // Outro exemplo de usuário bloqueado
        ];

        // --- USUÁRIOS COM IP FIXO ---
        // Usuários nesta lista terão o IP capturado no primeiro login e subsequentemente restrito a ele.
        const USERS_TO_TRACK_IP = [
            'ana',    // Exemplo: O login da Ana só funcionará do primeiro IP dela.
            'lara'    // Exemplo: O login da Lara só funcionará do primeiro IP dela.
        ];

        // Função assíncrona para obter o IP do cliente
        async function getClientIp() {
            try {
                // Usamos um serviço externo para obter o IP público.
                // Note que este serviço pode ser limitado em requisições ou indisponível.
                const response = await fetch('https://api.ipify.org?format=json');
                if (!response.ok) { // Verifica se a requisição foi bem-sucedida
                    console.error("Erro na requisição ao ipify.org:", response.statusText);
                    return null;
                }
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error("Erro ao obter o IP:", error);
                return null; // Retorna null em caso de erro
            }
        }

        // Função para lidar com o login
        loginButton.addEventListener('click', async () => {
            const username = usernameInput.value;
            const password = passwordInput.value;

            // 1. Verifica se as credenciais correspondem
            const userFound = USERS.some(user => user.username === username && user.password === password);

            if (userFound) {
                // 2. Verifica a lista negra
                const isBlocked = BLOCKED_USERS.includes(username);
                if (isBlocked) {
                    showMessage('Acesso negado. Este usuário está bloqueado.', 'error');
                    return;
                }

                // 3. Verifica o sistema de IP fixo
                const shouldTrackIp = USERS_TO_TRACK_IP.includes(username);
                console.log("Usuário a rastrear IP:", username, " - Deve rastrear IP?", shouldTrackIp); // DEBUG
                if (shouldTrackIp) {
                    const currentIp = await getClientIp(); // Obtém o IP atual do cliente
                    console.log("IP atual obtido:", currentIp); // DEBUG

                    if (!currentIp) {
                        showMessage('Não foi possível verificar seu IP. Tente novamente.', 'error');
                        return;
                    }

                    const storedIp = localStorage.getItem(`userIp_${username}`);
                    console.log("IP armazenado (localStorage):", storedIp); // DEBUG

                    if (storedIp) {
                        // Se já tem IP armazenado, compara
                        console.log("Comparando IPs:", storedIp, "vs", currentIp); // DEBUG
                        if (storedIp !== currentIp) {
                            showMessage('Acesso negado. Login permitido apenas do IP registrado para este usuário.', 'error');
                            return;
                        } else {
                            showMessage('IP verificado com sucesso. Login permitido.', 'success'); // DEBUG
                        }
                    } else {
                        // Se não tem IP armazenado, é o primeiro login deste IP. Armazena.
                        localStorage.setItem(`userIp_${username}`, currentIp);
                        console.log(`IP (${currentIp}) registrado para ${username} no localStorage.`); // DEBUG
                        showMessage(`IP (${currentIp}) registrado para ${username}.`, 'success');
                        // Não retorna, continua para o login bem-sucedido
                    }
                }

                // Se passou por todas as verificações, efetua o login
                loginPanel.classList.add('hidden');
                dashboardPanel.classList.remove('hidden');
                // showMessage('Login realizado com sucesso!', 'success'); // Já mostrou mensagem no IP verificado
            } else {
                showMessage('Usuário ou senha inválidos.', 'error');
            }
        });

        // Função para lidar com o logout
        logoutButton.addEventListener('click', () => {
            dashboardPanel.classList.add('hidden');
            loginPanel.classList.remove('hidden');
            usernameInput.value = '';
            passwordInput.value = '';
            showMessage('Você saiu da sua conta.', 'success');
        });

        // --- PONTO DE ALTERAÇÃO: FUNCIONALIDADES DOS BOTÕES ---
        function1Button.addEventListener('click', () => {
            showMessage('Função 1: scripts carregado com susesso!', 'success');
        });

        function2Button.addEventListener('click', () => {
            showMessage('Função 2: apostilas desbloqueadas com susesso!', 'success');
        });

        function3Button.addEventListener('click', () => {
            showMessage('Função 3: tuturias carregado com sucesso!', 'success');
        });

        window.onload = () => {
            loginPanel.classList.remove('hidden');
            dashboardPanel.classList.add('hidden');
        };
    </script>
</body>
</html>
